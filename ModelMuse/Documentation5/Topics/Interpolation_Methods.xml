<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Interpolation Methods</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Interpolation Methods</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The interpolation method of a data set is used to determine how values should be interpolated among a group of objects. Interpolation can only be used for 2-D data sets. Only one of the PHAST data sets, Initial_Water_Table, is a 2-D data set. All the data sets defining the boundaries between layers in MODFLOW are 2-D data sets. In addition, the user can define his or her own 2-D data sets and use interpolation with them. One appropriate use of such 2-D data sets in PHAST would be to define the tops and bottoms of geologic units.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Eight interpolation algorithms are available in ModelMuse: </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Normal" translate="true">, </text><text styleclass="Strong" translate="true">Point Average</text><text styleclass="Normal" translate="true">, </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Normal" translate="true">, </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> (Inverse Distance Squared), </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Normal" translate="true"> (Triangle Interpolation), </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Normal" translate="true">, </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> (Point Inverse Distance Squared), and </text><text styleclass="Strong" translate="true">Natural Neighbor</text><text styleclass="Normal" translate="true">. If the units of a data set are set to degrees or radians, All of these interpolation methods will be evaluated slightly differently in a way that is more appropriate for angles. See </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Interpolating_Angles" styleclass="Normal" translate="true">Specifying Angles for SUTRA</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Normal" translate="true"> interpolation method (fig. 18A) works by determining the object that is closest to the location where the data set in question is being evaluated. Then the formula of that object is evaluated at that location. If all the objects used with the method are point objects, the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Normal" translate="true"> interpolation method produces the same result more quickly (fig. 19) so the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Normal" translate="true"> interpolation method is generally used for line or polygon objects.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Strong" translate="true">Point Average</text><text styleclass="Normal" translate="true"> is only used where there are expected to be enough points so that every cell or element contains at least one point. The value assigned to the element or cell will be the arithmetic average of those points. If no points are in a cell or element, the cell or element will be assigned a value of zero.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Normal" translate="true"> interpolation method (fig. 18B) is similar to the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Normal" translate="true"> interpolation method except that only the vertices of objects are considered, rather than the lines connecting the vertices. If only point objects are used, the result is identical. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Normal" translate="true"> interpolation method uses an algorithm that is faster (fig. 19) than the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Normal" translate="true"> interpolation method when the number of points is greater than several hundred. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Normal" translate="true"> interpolation method is the fastest of all the interpolation methods when used with point data (fig. 19). If used with line or polygon data it can be slower than the </text><text styleclass="Strong" translate="true">Nearest</text><text styleclass="Normal" translate="true"> interpolation especially if many of the object vertices lie outside the grid.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">With the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> interpolation method (fig. 18C), the formula for each object is evaluated at the location under consideration. The final value is a weighted average of these values. The weights are the inverse of the distance squared from the location to the closest point on each respective object. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> interpolation method may only be used with data sets containing real numbers. Because the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> interpolation method is slow (fig. 19), it generally is not used with more than a few hundred objects. If the formulas for all the objects are numbers and all the objects are point objects, the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq. </text><text styleclass="Normal" translate="true">interpolation method gives the same results more quickly (fig. 19).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:normal;" translate="true">With the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq. </text><text styleclass="Normal" translate="true">interpolation method (fig. 18D), the formula for each vertex for each object is evaluated at its own location. The final value is a weighted average of these values. The weights are the inverse of the distance squared from the location of interest to the vertex. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> interpolation method may only be used with data sets containing real numbers. If the formulas for all the objects are numbers and all the objects are point objects, the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq. </text><text styleclass="Normal" translate="true">interpolation method gives the same results as the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Normal" translate="true"> interpolation method but does so more quickly (fig. 19).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> interpolation method (fig. 18E) evaluates the formula for each object at the location of each vertex on the object. It then creates an unconstrained Delaunay triangulation of all the vertices (the same one as in </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.)</text><text styleclass="Normal" style="font-weight:normal;" translate="true">. A piece-wise continuous function of the locations is fitted through the data values and the function is used to assign values at each location of interest. This method was created by Renka (1996a, b). </text><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface </text><text styleclass="Normal" translate="true">interpolation method may only be used with data sets containing real numbers. Interpolated values returned by </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Normal" translate="true"> may be higher than the highest value at any data point or lower than the lowest value at any data point. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> interpolation method is a relatively fast interpolation method (fig. 19).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> interpolation method (fig. 18F) evaluates the formula for each object at the location of each vertex on the object. It then creates an unconstrained Delaunay triangulation of all the vertices. If a location where a value is needed is inside one of the triangles, the value assigned to that location will be calculated by fitting a plane to the three points of the triangle and determining the height of the plane at the location of interest. Other locations will be assigned the value that would have been assigned to the closes location on the convex hull of the data points. This method was created by Renka (1996a, b). </text><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp. </text><text styleclass="Normal" translate="true">interpolation method may only be used with data sets containing real numbers. Interpolated values returned by </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Normal" translate="true"> are never higher than the highest value at any data point or lower than the lowest value at any data point. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> interpolation method is a relatively fast interpolation method (fig. 19).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:normal;" translate="true">The </text><text styleclass="Strong" translate="true">Natural Neighbor</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> interpolation method (fig. 18G) uses a weighted average of some points near the location of interest. A more detailed description of this method may be found in </text><link displaytype="text" defaultstyle="true" type="weblink" href="http://en.wikipedia.org/wiki/Natural_neighbor" target="_blank" styleclass="Normal" style="font-weight:normal;" translate="true">http://en.wikipedia.org/wiki/Natural_neighbor</link><text styleclass="Normal" style="font-weight:normal;" translate="true">. O</text><text styleclass="Normal" translate="true">nly the vertices of objects are considered, rather than the lines connecting the vertices. </text><text styleclass="Normal" style="font-weight:normal;" translate="true">The </text><text styleclass="Strong" translate="true">Natural Neighbor</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> method is similar in speed to the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface </text><text styleclass="Normal" translate="true">methods</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> (fig. 19)</text><text styleclass="Normal" translate="true"> but uses more memory</text><text styleclass="Normal" style="font-weight:normal;" translate="true">. </text><text styleclass="Normal" translate="true">The </text><text styleclass="Strong" translate="true">Natural Neighbor</text><text styleclass="Normal" style="font-weight:bold;" translate="true"> </text><text styleclass="Normal" translate="true">interpolation method may only be used with data sets containing real numbers. Unlike the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Normal" style="font-weight:normal;" translate="true"> method, i</text><text styleclass="Normal" translate="true">nterpolated values returned by </text><text styleclass="Strong" translate="true">Natural Neighbor</text><text styleclass="Normal" translate="true"> are never higher than the highest value at any data point nor lower than the lowest value at any data point. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">A special modification of the interpolation method is used when the units of a data set are set to Degrees or Radians. See </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Interpolating_Angles" styleclass="Normal" translate="true">Specifying Angles for SUTRA</link><text styleclass="Normal" translate="true">.</text></para>
    <para style="text-indent:48px;"></para>
    <para styleclass="Normal" style="text-align:center; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><table rowcount="8" colcount="2" style="width:450px; cell-padding:4px; cell-spacing:0px; page-break-inside:avoid; border-width:0px; border-spacing:0px; cell-border-width:0px; border-style:none; background-color:none; head-row-background-color:none; alt-row-background-color:none;">
      <tr style="vertical-align:top">
        <td style="vertical-align:top; width:387px; height:129px;">
          <para style="page-break-inside:avoid; page-break-after:avoid;"><image src="InterpolationNearest.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Nearest interpolation method</title></image></para>
        </td>
        <td style="vertical-align:top; width:351px; height:129px;">
          <para style="page-break-inside:avoid; page-break-after:avoid;"><image src="InterpolationNearestPoint.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Nearest Point interpolation method</title></image></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:24px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-right:0px; margin-left:0px; tabstops:none;"><text styleclass="Table Image Caption" translate="true">A</text></para>
        </td>
        <td style="width:351px; height:24px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:auto; page-break-after:auto; tabstops:none;"><text styleclass="Table Image Caption" translate="true">B</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:120px;">
          <para style="page-break-inside:avoid; page-break-after:avoid;"><image src="InterpolationInvDistSq.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Inv. Dist. Sq. interpolation method</title></image></para>
        </td>
        <td style="width:351px; height:120px;">
          <para styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><image src="InterpolationPointInvDistSq.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Point Inv. Dist. Sq. interpolation method</title></image></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:383px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><text styleclass="Table Image Caption" translate="true">C</text></para>
        </td>
        <td style="width:383px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><text styleclass="Table Image Caption" translate="true">D</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:19px;">
          <para styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><image src="InterpolationFittedSurface.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Fitted Surface interpolation method</title></image></para>
        </td>
        <td style="width:351px; height:19px;">
          <para styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><image src="InterpolationTriangleInterp.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"><title translate="true">results of Triangle Interp. interpolation method</title></image></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><text styleclass="Table Image Caption" translate="true">E</text></para>
        </td>
        <td style="width:351px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><text styleclass="Table Image Caption" translate="true">F</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><image src="InterpolationNaturalNeighbor.bmp" scale="-99.90%" width="202" height="204" styleclass="Image Caption"></image></para>
        </td>
        <td style="width:351px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td style="width:387px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"><text styleclass="Table Image Caption" translate="true">G</text></para>
        </td>
        <td style="width:351px; height:19px;">
          <para styleclass="Table Image Caption" style="text-align:left; text-indent:12px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:avoid; tabstops:none;"></para>
        </td>
      </tr>
    </table></para>
    <para styleclass="Image Caption" style="text-align:left; text-indent:0px; margin-right:0px; margin-left:0px; tabstops:none;"><text styleclass="Image Number" translate="true">Figure 18</text><text styleclass="Image Caption" translate="true"> Interpolation methods. The points and lines are objects with different values. The figures show how the interpolated values vary among interpolation methods when applied to the same data.—(A) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Nearest</text><text styleclass="Image Caption" translate="true"> interpolation method, (B) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Nearest Point</text><text styleclass="Image Caption" translate="true"> interpolation method, (C) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Inv. Dist. Sq.</text><text styleclass="Image Caption" translate="true"> interpolation method, (D) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Point Inv. Dist. Sq.</text><text styleclass="Image Caption" translate="true"> interpolation method, (E) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Fitted Surface</text><text styleclass="Image Caption" translate="true"> interpolation method, (F) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Triangle Interp.</text><text styleclass="Image Caption" translate="true"> interpolation method, and (G) </text><text styleclass="Image Caption" style="font-weight:bold;" translate="true">Natural Neighbor</text><text styleclass="Image Caption" translate="true"> interpolation method.</text></para>
    <para styleclass="Image Caption"><table rowcount="2" colcount="1" style="width:auto; cell-padding:0px; cell-spacing:0px; page-break-inside:auto; border-width:0px; border-spacing:0px; cell-border-width:0px; border-style:none; background-color:none; head-row-background-color:none; alt-row-background-color:none;">
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Image Caption" style="text-align:center; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:auto; page-break-after:avoid; tabstops:none;"><image src="SpeedTest2_1.gif" scale="-99.90%" styleclass="Image Caption"><title translate="true">See caption</title></image></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Image Caption" style="text-align:left;"><text styleclass="Image Number" translate="true">Figure 19</text><text styleclass="Image Caption" translate="true">. Time required to assign values to a grid with 10,000 cells as a function of the number of points using the various interpolation methods. Experiments were performed using a 2.0 GHz CPU.</text></para>
        </td>
      </tr>
    </table></para>
  </body>
</topic>
