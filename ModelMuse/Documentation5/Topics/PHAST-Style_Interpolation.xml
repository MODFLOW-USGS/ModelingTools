<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">PHAST-Style Interpolation</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">PHAST-Style Interpolation</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">PHAST has a built-in interpolation method using the grid coordinate system that can be applied to some properties using keyword data blocks of the following types (Parkhurst and others, 2004):</text></para>
    <list id="7" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" translate="true">CHEMISTRY_IC, </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">FLUX_BC, </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">HEAD_IC, </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">LEAKY_BC, </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">MEDIA, and </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">SPECIFIED_HEAD_BC.</text></li>
    </list>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In a PHAST-style interpolation, the user specifies a coordinate direction (X, Y, or Z), two distances, and two values. The coordinate direction is relative to the grid so if the grid is at an angle these are actually the X&apos;, Y&apos; and Z directions (fig. 20). If the X&apos;, Y&apos;, or Z coordinate of the current node is less than or equal to the first distance, the first value (Value 1) is used. If the X&apos;, Y&apos;, or Z coordinate of the current node is greater than or equal to the second distance, the second value (Value 2) is used. For intermediate distances, linear interpolation between the two values is used.</text></para>
    <para styleclass="Normal" style="text-indent:0px; margin-right:0px; margin-left:0px; tabstops:none;"><snippet src="Figure_19"/></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">A related capability in PHAST is the ability to specify mixtures between two chemical compositions. In PHAST-style mixtures, the user specifies two values that represent chemical compositions and a series of proportions (between 0 and 1). The proportion represents the fraction of Value 1 in the mixture. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The following controls are used to specify the values needed for PHAST-style interpolation.</text></para>
    <list id="8" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Interp. dir. or mixture</text><text styleclass="Normal" translate="true">: Interp. dir. or mixture indicates the direction in which the interpolation will take place. For some data sets, the user can specify </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mix</text><text styleclass="Normal" translate="true">. If </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mix</text><text styleclass="Normal" translate="true"> is specified, the mixture formula is used to specify the fraction of </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> in the mixture.</text></li>
    </list>
    <list id="9" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 1</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 2</text><text styleclass="Normal" translate="true">: </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 1</text><text styleclass="Normal" translate="true"> is the lower end of the distances used for interpolation. </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 2</text><text styleclass="Normal" translate="true"> is the upper end of the distances used for interpolation. If the position of a cell or element is between </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 1</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Distance 2</text><text styleclass="Normal" translate="true">, the value applied to a cell will be interpolated between </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1 </text><text styleclass="Normal" translate="true">and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 2</text><text styleclass="Normal" translate="true">. Otherwise, either </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> or </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 2</text><text styleclass="Normal" translate="true"> will be applied depending on which end of the range of distances is closest to the position of the cell or element.</text></li>
    </list>
    <list id="10" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 2</text><text styleclass="Normal" translate="true">: </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 2</text><text styleclass="Normal" translate="true"> are the two values that will be used for interpolation.</text></li>
    </list>
    <list id="11" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Mixture formula</text><text styleclass="Normal" translate="true">: </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mixture formula</text><text styleclass="Normal" translate="true"> is the fraction of </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> to use in the mixture of </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 1</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Value 2</text><text styleclass="Normal" translate="true">. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mixture formula</text><text styleclass="Normal" translate="true"> should range between 0 and 1. If the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mixture formula</text><text styleclass="Normal" translate="true"> is outside the range of 0 to 1, a value of either 0 or 1 will be used depending on which is closest to the value of the mixture formula.</text></li>
    </list>
    <para styleclass="Normal" style="text-align:left; text-indent:48px; margin-top:0px; margin-right:0px; margin-bottom:10px; margin-left:0px; line-height:1.0; white-space:normal; page-break-inside:avoid; page-break-after:auto; tabstops:none;"><text styleclass="Normal" translate="true">PHAST-style interpolation in ModelMuse can only be applied to data sets in PHAST that allow PHAST-style interpolation. This includes all the data sets directly used in the PHAST transport data file except Active, Print_Chemistry, and Print_XYZ_Chemistry. PHAST-style interpolation cannot be used with data sets created by the user. However, the user could specify a formula that would have the same effect as PHAST-style interpolation. Either of the following will emulate PHAST-style interpolation when applied to a real-number data set:</text></para>
    <list id="12" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:2.0; white-space:normal; page-break-inside:auto; page-break-after:avoid; tabstops:none; font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:2.0; white-space:normal; page-break-inside:auto; page-break-after:avoid; tabstops:none;"><text styleclass="Normal" translate="true">If((X_Prime &lt; 1000.), 25., If((X_Prime &gt; 10000.), 60., ((((X_Prime - 1000.) / 9000.) * 35.) + 25.)))</text></li>
    </list>
    <list id="13" type="ul" listtype="bullet" formatstring="·" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:2.0; white-space:normal; page-break-inside:auto; page-break-after:auto; tabstops:none; font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:2.0; white-space:normal; page-break-inside:auto; page-break-after:auto; tabstops:none;"><text styleclass="Normal" translate="true">MultiInterpolate(X_Prime, 25, 1000, 60, 10000)</text></li>
    </list>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In these formulas, the interpolation direction is X&apos;, the two distances are 1,000 and 10,000, and the two values are 25 and 60.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Data sets that store integers and whose values are set by PHAST-style interpolation or mixtures should not be used in formulas for other data sets because the value used in the formula will be rounded to the nearest integer rather than representing a mixture between the two end member compositions. The formulas used in ModelMuse are strictly mathematical and are unable to interpret those numbers as chemical compositions.</text></para>
  </body>
</topic>
