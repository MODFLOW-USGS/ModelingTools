<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2022-06-02T20:22:15.990-04:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Island 3D model</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Island 3D Model</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">This example is a variation on example 6.8 from the </text><link displaytype="text" defaultstyle="true" type="weblink" href="http://pubs.er.usgs.gov/publication/wri024231" target="_blank" styleclass="Normal" translate="true">SUTRA 2.2 documentation</link><text styleclass="Normal" translate="true"> (Variable-Density Saturated-Unsaturated Flow and Solute Transport). In this model, there is a circular island surrounded by the ocean. The water table is at sea level and has the same salinity as seawater. Recharge over the island displaces the seawater to create a fresh water lens. Unlike example 6.8, in this model, the direction of maximum permeability is directed radially outward from the center of the island and directed downward at an angle of 20 degrees. Part of the objective of this example is to demonstrate a simple way to specify that permeability direction. Also, unlike example 6.8, the entire island will be simulated rather than 1/4 of it.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The island with a radius of 500 m. The model will extend out into the ocean to a radius of 800 m. As with the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Henry_2D_Model" styleclass="Normal" translate="true">Henry 2D model</link><text styleclass="Normal" translate="true">, the first step will be to use a model with just a specified pressure boundary to set the initial pressure. Then a flux boundary will be added to the top surface over the island. The mesh density at the shoreline needs to be finer than either the center of the island or further out in the ocean. The top of the model will be at 5 m in the center of the island out to 400 m from the center. The top of the model will be 0 at the shoreline and -5 beyond 700 m from the center of the island. Two layer groups will be used to define the layers. The upper one will be 5 m thick and be subdivided into 5 layers. The lower one will extend down to -100 m and be subdivided into 20 layers.</text></para>
    <list id="0" type="ol" listtype="decimal" formatstring="&#37;&#48;&#58;&#115;&#46;" format-charset="DEFAULT_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Start ModelMuse and select </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Create new SUTRA model</text><text styleclass="Normal" translate="true">. Click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Next</text><text styleclass="Normal" translate="true">. Specify &quot;Not Applicable&quot; for the projection. Then click the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Next</text><text styleclass="Normal" translate="true"> button again.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Set </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mesh type</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">3D</text><text styleclass="Normal" translate="true">, and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Transport</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Simulation using pressure</text><text styleclass="Normal" translate="true">. Set </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Flow conditions</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Unsaturated</text><text styleclass="Normal" translate="true">. Set both the lower X and lower Y coordinates to -900 and the upper X and upper Y coordinates to 900. Set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of layer groups</text><text styleclass="Normal" translate="true"> to 2. Change the layer group names to Unsaturated and Aquifer respectively. Set the elevations to 5, 0, and -100. Click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Finish</text><text styleclass="Normal" translate="true">.</text><br/><image src="IslandStartUp.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Draw a </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Creating_Objects" styleclass="Normal" translate="true">polygon object</link><text styleclass="Normal" translate="true"> as a roughly circular region with a radius of 800 m. It can be centered at the origin but it doesn&apos;t have to be. This object will define the domain outline. In the Object Properties dialog box, check the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Use to set element size</text><text styleclass="Normal" translate="true"> check box and set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Mesh element size</text><text styleclass="Normal" translate="true"> to 100. Click OK.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">We need a finer element size near the shoreline at 500 m. However, if we use a polygon object, that polygon will be treated as a hole in the mesh rather than just specifying the element size. However, if we have two intersecting objects (or one object with two intersecting sections) they can define a finer mesh along the shoreline without creating a hole in the mesh. Create polyline objects to define the shoreline and specify a mesh element size of 10. A similar strategy can be used for define a zone with coarser elements within 400 m of the center of the island and a mesh element size of 40. You might end up with objects similar to these.</text><br/><image src="Island3D_MeshingObjects.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">To generate the mesh, select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mesh_Generation_Control_Variab" styleclass="Normal" style="font-weight:bold;" translate="true">Mesh|Generate Mesh</link><text styleclass="Normal" style="font-weight:bold;" translate="true">...</text><text styleclass="Normal" translate="true"> or click the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Generate mesh</text><text styleclass="Normal" translate="true">&#32;</text><image src="GenerateGrid.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image><text styleclass="Normal" translate="true"> button. You can use the default </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mesh_Generation_Control_Variab" styleclass="Normal" style="font-weight:bold;" translate="true">Control variables</link><text styleclass="Normal" translate="true"> or change them. Try changing the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Element growth rate</text><text styleclass="Normal" translate="true"> to 1.1 or 1.2 and then click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">OK</text><text styleclass="Normal" translate="true"> to generate the mesh. </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">You may get a warning message that one or more invalid elements were created. Even if you don&apos;t get such a warning, it is a good idea to examine the mesh to make sure it doesn&apos;t have any elements that are too narrow. To do that, first </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Changing_the_Magnification" styleclass="Normal" translate="true">zoom in</link><text styleclass="Normal" translate="true"> on a small area of the mesh. It doesn&apos;t matter where. Then select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Customize_SUTRA_Mesh_Dialog_Bo" styleclass="Normal" style="font-weight:bold;" translate="true">View|Customize SUTRA Mesh</link><text styleclass="Normal" translate="true">. In the dialog box, check </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Show element numbers</text><text styleclass="Normal" translate="true"> and click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Apply</text><text styleclass="Normal" translate="true">. Then select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mesh_Information_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Mesh|View Mesh Information</link><text styleclass="Normal" translate="true">.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">The angles made by all the element corners will be listed on the Element Angles tab. If there are any angles ≥ 180, there will be two tables on this tab with the elements with angles that are too large listed on one of the tables. Otherwise, there will only be one table. If you click in a table a </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Go to</text><text styleclass="Normal" translate="true"> button will appear. Clicking it will move you to the element listed in the same cell as the button. You can also look at the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Aspect Ratios</text><text styleclass="Normal" translate="true"> tab where there is a similar table of aspect ratios. You should check some of the elements with the smallest aspect ratios to see if they seem too narrow. </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">If you have any elements that are problematic, you can either edit the mesh manually to fix the problem, adjust the objects used to define the mesh slightly and generate the mesh again, or generate the mesh using different </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mesh_Generation_Control_Variab" styleclass="Normal" style="font-weight:bold;" translate="true">Control variables</link><text styleclass="Normal" translate="true">. It may take some experimentation to generate an acceptable mesh. </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Next select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUTRA_Options_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Model|SUTRA Options</link><text styleclass="Normal" translate="true">. On the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Title_Pane" styleclass="Normal" style="font-weight:bold;" translate="true">Title</link><text styleclass="Normal" translate="true"> pane enter a title of your choice. On the Solver pane, choose an iterative solver for both pressure and transport. Click OK to close the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUTRA_Options_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA Options</link><text styleclass="Normal" translate="true"> dialog box.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Next we will set some of the aquifer properties. Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Data|Edit Data Sets</link><text styleclass="Normal" translate="true">. First select </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA Mesh Top</text><text styleclass="Normal" translate="true"> under </text><text styleclass="Strong" translate="true">Required|Layer </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Definition</text><text styleclass="Normal" translate="true"> and set its </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Interpolation</text><text styleclass="Normal" translate="true"> method to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Natural Neighbor</text><text styleclass="Normal" translate="true">. Set the following formulas for the data sets shown in the table below. </text></li>
    </list>
    <para styleclass="Normal" style="margin-left:24px;"><table styleclass="Default" rowcount="7" colcount="2" style="cell-padding:2px; cell-spacing:2px; border-width:2px; border-spacing:2px; cell-border-width:1px; border-color:#000000; border-style:raised-color;">
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Table Header"><text styleclass="Table Header" translate="true">Data Set</text></para>
        </td>
        <td>
          <para styleclass="Table Header"><text styleclass="Table Header" translate="true">Formula</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Longitudinal_Dispersivity_Max_Dir</text></para>
        </td>
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">10</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Maximum_Permeability</text></para>
        </td>
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">5E-12</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Minimum_Permeability</text></para>
        </td>
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Maximum_Permeability / 10</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Nodal_Porosity</text></para>
        </td>
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">0.1</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Transverse_Dispersivity_Max_Dir</text></para>
        </td>
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">0.1</text></para>
        </td>
      </tr>
      <tr style="vertical-align:top">
        <td>
          <para styleclass="Normal"><text styleclass="Normal" translate="true">Unsaturated_Bottom</text></para>
        </td>
        <td>
          <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text style="font-family:Arial; font-size:12pt; color:#000000;" translate="true">SUTRA_Mesh_Top - 5.</text></para>
        </td>
      </tr>
    </table></para>
    <list id="1" type="ol" listtype="decimal" formatstring="&#37;&#48;&#58;&#115;&#46;" format-charset="DEFAULT_CHARSET" levelreset="true" legalstyle="false" startfrom="11" styleclass="Normal" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" translate="true">The next thing to do is to define the top of the model. We will use interpolation among objects to do that. We can reuse the three objects that define the mesh plus a new fourth object at a distance of 700 m from the center of the island. First double-click on the object that defines the domain outline to open the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. On the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Properties_Tab" styleclass="Normal" style="font-weight:bold;" translate="true">Properties</link><text styleclass="Normal" translate="true"> tab, change </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Evaluated at</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nodes</text><text styleclass="Normal" translate="true"> and the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Zero</text><text styleclass="Normal" translate="true">. Uncheck </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of enclosed nodes</text><text styleclass="Normal" translate="true"> and check </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of nodes by interpolation</text><text styleclass="Normal" translate="true">. On the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Tab" styleclass="Normal" style="font-weight:bold;" translate="true">Data Sets</link><text styleclass="Normal" translate="true"> tab, check the check box for </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA_Mesh_Top</text><text styleclass="Normal" translate="true"> (under </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Required|Layer Definition</text><text styleclass="Normal" translate="true">) and set the formula to -5. Click OK to close the dialog box. Do the same with the objects that define the interior of the island and the shoreline and use them assign values to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA_Mesh_Top</text><text styleclass="Normal" translate="true"> of 5 and 0 respectively. Then create another polygon object that circles the island at a distance of 700 m from its center and use it to assign a value of -5 to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA_Mesh_Top</text><text styleclass="Normal" translate="true"> by interpolation.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">For the next few steps, we will need to use the concentration of seawater in some of our calculations. We will define a global variable to specify the concentration of seawater. Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Global_Variables_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Data|Edit Global Variables</link><text styleclass="Normal" translate="true">. Name the new variable &quot;csea&quot; and set its value to 0.0357. To remind ourselves of what csea is set the Comment to &quot;Concentration of Seawater.&quot;</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Data|Edit Data Sets</link><text styleclass="Normal" translate="true"> and set the formula for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">InitialConcentration</text><text styleclass="Normal" translate="true"> data set to csea</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">We will also need to calculate the specific weight of water, ρg. where ρ is the density or water and g is gravity (9.81). We will define a new data set name RhoG. We can calculate the density of water as (1000. + (700. * csea)) so the entire formula for RhoG would be (1000. + (700. * csea)) * 9.81. Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Data|Edit Data Sets</link><text styleclass="Normal" translate="true"> and create a new data set named RhoG. Make sure it is </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Evaluated at</text><text styleclass="Normal" translate="true">&#32;</text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nodes</text><text styleclass="Normal" translate="true">. Set its formula as described above.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Next we want to assign a pressure boundary along the vertical edge of the model and along the top surface of the model where it is beyond the shoreline. For the vertical edge of the model, we want to use the object that defines the domain outline but we can&apos;t because we are already using it to define help define the top of the model. To help define the top of the model, the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> must be </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Zero</text><text styleclass="Normal" translate="true">. For the pressure boundary we will need to set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Two</text><text styleclass="Normal" translate="true">. However, we can make a copy of the domain outline object and change its </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true">. Select the domain outline object and copy it the the clipboard. Then paste it back from the clipboard.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Double-click on the new object to open it in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. On the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Tab" styleclass="Normal" style="font-weight:bold;" translate="true">Data Sets</link><text styleclass="Normal" translate="true"> tab, uncheck the check box for </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA_Mesh_Top</text><text styleclass="Normal" translate="true">. On the Properties tab, uncheck the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Use to set element size</text><text styleclass="Normal" translate="true"> check box and the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of nodes by interpolation</text><text styleclass="Normal" translate="true"> check box. Check the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of intersected nodes</text><text styleclass="Normal" translate="true"> check box. Set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Two</text><text styleclass="Normal" translate="true">. Set formula for the Higher Z coordinate to &quot;SUTRA_Mesh_Top + 1&quot; and the formula for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Lower Z coordinate</text><text styleclass="Normal" translate="true"> to &quot;Aquifer Bottom - 1.&quot; (These formulas put the top of the object above the top of the mesh and bottom of the object below the bottom of the mesh so that it doesn&apos;t affect any nodes in the interior of the mesh.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Next switch to the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUTRA_Features_Tab" styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA Features</link><text styleclass="Normal" translate="true"> tab and check the check box for </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Specified Pressure</text><text styleclass="Normal" translate="true">. In the table, set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Time</text><text styleclass="Normal" translate="true"> to 0, check the check box for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Used</text><text styleclass="Normal" translate="true"> column, set the formula for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Specified pressure</text><text styleclass="Normal" translate="true"> to &quot;-RhoG * Z,&quot; and the formula for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Associated concentration</text><text styleclass="Normal" translate="true"> to &quot;csea.&quot; Click OK to close the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">We want another specified pressure boundary where the model top is in the ocean rather than on shore. We will use a little trick to do this. First, draw a polygon object completely around the mesh. In the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box, change </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Evaluated At</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nodes</text><text styleclass="Normal" translate="true"> and change the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Strong" translate="true">One</text><text styleclass="Normal" translate="true">. Change the formula for the Z coordinate to &quot;If((SUTRA_Mesh_Top &lt;= 0.), SUTRA_Mesh_Top, (SUTRA_Mesh_Top + 1.)).&quot; This formula places the object above the top of the mesh over the island but at the top of the mesh under the ocean.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Try </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Color_Grid_Dialog_Box" styleclass="Normal" translate="true">coloring the grid</link><text styleclass="Normal" translate="true"> with the specified pressure to make sure it is being assigned properly. If it isn&apos;t, you can use the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Grid_Value_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Grid or Mesh Value</link><text styleclass="Normal" translate="true"> dialog box to help figure out what is going wrong.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">The next thing to do is to set the direction of the maximum permeability. Recall that it should be radiating out from the center of the mesh and downward at an angle of 20°. We are going to need another data set when setting the angles.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Data|Edit Data Sets</link><text styleclass="Normal" translate="true"> and create a new data set named &quot;PermDir.&quot; Make sure </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Evaluated at</text><text styleclass="Normal" translate="true"> is set to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Elements</text><text styleclass="Normal" translate="true">. Set the interpolation method to Inv. Dist Sq. and (this is important) set the units to &quot;Degrees.&quot; By setting the unit to degrees, interpolation will be performed using a special method. Instead of interpolating the raw angles which would often result in bad interpolated values, the sines and cosines of the angles are interpolated and then recombined into an angle at each location where an interpolated angle is needed.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Before closing the Data Sets dialog box, select the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Angle_Horizontal</text><text styleclass="Normal" translate="true"> data set and set its formula to &quot;PermDir.&quot; We need to use the intermediate &quot;PermDir&quot; data set because the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Angle_Horizontal</text><text styleclass="Normal" translate="true"> data set is a 3D data set and interpolation is not allowed on 3D data sets.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Now we are going to create some objects radiating out from the center of the island and use the orientation of these objects to set the direction of maximum permeability. Draw a polyline object with two vertices starting at the center of the island and extending east toward the edge of the island. In the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. Set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Zero</text><text styleclass="Normal" translate="true"> and on the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Data Sets</text><text styleclass="Normal" translate="true"> tab, Uncheck </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of intersected elements</text><text styleclass="Normal" translate="true"> and check </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Set values of elements by interpolation</text><text styleclass="Normal" translate="true">. check the check box for PermDir and set its formula to &quot;ObjectCurrentSegmentAngleDegrees&quot; This function returns the angle of the segment of the object that is being used to set the value of an element or nodel Draw three more polyline objects extending North, South and West and use them to set the value of PermDir in the same way.</text><br/><image src="Island3D_MaxPerm.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">To check that the first angle has been set correctly, we can use a vector plot of the permeability. Select </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Data|Data Visualization...</text><text styleclass="Normal" translate="true"> or click the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Data visualization</text><text styleclass="Normal" translate="true">&#32;</text><image src="DataVisualizationButton.bmp" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image><text styleclass="Image Caption" translate="true">&#32;</text><text styleclass="Normal" translate="true">button and go to the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Vectors</text><text styleclass="Normal" translate="true"> pane. Select </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Permeability</text><text styleclass="Normal" translate="true"> as the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Vector Source</text><text styleclass="Normal" translate="true"> and click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Apply</text><text styleclass="Normal" translate="true">. You should be able to see the vectors on the mesh. If in some areas, the vectors appear completely wrong check that all the objects that are being used to set PermDir set the values of elements by interpolation. You can try experimenting with the interpolation method for PermDir to see how that affects the vectors.</text><br/><image src="Island3D_PermeabilityVectors.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Setting the vectors to point downward by 20° can be done in the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Data Sets</text><text styleclass="Normal" translate="true"> dialog box. Set the formula of the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Angle_Vertical</text><text styleclass="Normal" translate="true"> data set to -20. The effect on the vectors should be most obvious on the front view of the model.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">We still haven&apos;t subdivided the layer groups into multiple layers. We will do that now. Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUTRA_Layer_Groups_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Model|SUTRA Layer Groups...</link><text styleclass="Normal" translate="true"> Select the Unsaturated layer group and set its </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Vertical discretization</text><text styleclass="Normal" translate="true"> to 5. Select the Aquifer layer group and set its </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Vertical discretization</text><text styleclass="Normal" translate="true"> to 20. Click OK.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Save the model with a name that indicates it is being used to specify the initial pressure.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Run the SUTRA model (</text><text styleclass="Normal" style="font-weight:bold;" translate="true">File|Export|SUTRA input files</text><text styleclass="Normal" translate="true">).</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Save the model again with a different name that indicates it is being used for the transient simulation.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Configuration_Pane" styleclass="Normal" style="font-weight:bold;" translate="true">Model|SUTRA Options</link><text styleclass="Normal" translate="true"> and change the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Simulation type</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Transient flow, transient transport</text><text styleclass="Normal" translate="true">. Go to the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Initial_Conditions_Pane" styleclass="Normal" style="font-weight:bold;" translate="true">Initial Conditions</link><text styleclass="Normal" translate="true"> pane and and set the </text><text styleclass="Strong" translate="true">Starting type</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Strong" translate="true">Cold start</text><text styleclass="Normal" translate="true">. &#160;Check </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Read the pressure/head from the restart file</text><text styleclass="Normal" translate="true">. Select the restart file generated when you ran the model for the initial pressure. Click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">OK</text><text styleclass="Normal" translate="true"> to close the dialog box.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Select </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUTRA_Time_Controls_Dialog_Box" styleclass="Normal" style="font-weight:bold;" translate="true">Model|SUTRA Time Controls...</link><text styleclass="Normal" translate="true"> Set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Maximum number of times after the initial time (NTMAX)</text><text styleclass="Normal" translate="true"> to 100 and the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Initial time increment TIMEC</text><text styleclass="Normal" translate="true"> to 6311520. Click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">OK</text><text styleclass="Normal" translate="true"> to close the dialog box.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Select </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Model|SUTRA Output Control...</text><text styleclass="Normal" translate="true"> and set the frequency of printing to both the Listing file and the node and element files to every 25 time steps.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Next we need to define the fluid flux boundary. The recharge rate is 2.3766E-5. This needs to be multiplied by the area of the cell surrounding the node to get the volumetric recharge rate. Draw a polygon object completely surrounding the mesh. Set </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Evaluated at</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nodes</text><text styleclass="Normal" translate="true"> and set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Number of Z formulas</text><text styleclass="Normal" translate="true"> to </text><text styleclass="Normal" style="font-weight:bold;" translate="true">One</text><text styleclass="Normal" translate="true">. Set the Z formula to &quot;If((SUTRA_Mesh_Top &gt; 0.), SUTRA_Mesh_Top, (SUTRA_Mesh_Top + 1.)).&quot; This formula is similar to the one for the specified pressure boundary on the top of the model except that it causes the object to be above the top of the mesh offshore and at the top of the mesh onshore. Switch to the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">SUTRA Features</text><text styleclass="Normal" translate="true"> tab and check the check box for </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fluid Flux</text><text styleclass="Normal" translate="true">. Flux boundaries can&apos;t begin at time step 0. They have to begin at time step 1 or later so set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Time</text><text styleclass="Normal" translate="true"> for the flux boundary to 6311520. Check the check box in the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Used</text><text styleclass="Normal" translate="true"> column. Set the formula for the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Fluid source</text><text styleclass="Normal" translate="true"> to &quot;2.3766E-5 * ObjectIntersectArea&quot; and the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Associated concentration</text><text styleclass="Normal" translate="true"> to 0. Click </text><text styleclass="Normal" style="font-weight:bold;" translate="true">OK</text><text styleclass="Normal" translate="true"> to close the dialog box.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">You can color the mesh with the fluid source to make sure it is being applied correctly. Make sure you specify the time as 6311520 or greater.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Run the SUTRA model (</text><text styleclass="Normal" style="font-weight:bold;" translate="true">File|Export|SUTRA input files</text><text styleclass="Normal" translate="true">).</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">When the model is done running import the model results (</text><text styleclass="Normal" style="font-weight:bold;" translate="true">File|Import|Model Results... </text><image src="ImportModelResults.bmp" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"><title translate="true">Import and display model results button</title></image><text styleclass="Normal" translate="true">) and color the mesh with the concentration in the last time step. If you position the cross section through the center of the island, you should see that the fresh water extends deepest not at the center of the island but part way to the edge. This is the result of the maximum permeability sloping downward and away from the center of the island.</text><br/><image src="Island3D_Concentration100.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"></image></li>
    </list>
  </body>
</topic>
